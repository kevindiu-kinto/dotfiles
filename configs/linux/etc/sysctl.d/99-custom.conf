# Security hardening
kernel.dmesg_restrict = 1
kernel.kptr_restrict = 2
net.core.bpf_jit_harden = 2
kernel.yama.ptrace_scope = 1

# Enhanced kernel hardening
kernel.kexec_load_disabled = 1
kernel.unprivileged_bpf_disabled = 1
kernel.unprivileged_userns_clone = 0
net.ipv4.conf.all.log_martians = 1
net.ipv4.conf.default.log_martians = 1

# Container-specific security
kernel.core_pattern = |/bin/false
fs.suid_dumpable = 0
kernel.randomize_va_space = 2

# Memory protection
vm.mmap_min_addr = 65536

# Performance optimization
vm.swappiness = 10
vm.dirty_ratio = 15
vm.dirty_background_ratio = 5

# Enhanced VM settings for container performance
vm.dirty_expire_centisecs = 1500
vm.dirty_writeback_centisecs = 500
vm.overcommit_memory = 1
vm.overcommit_ratio = 50
vm.max_map_count = 262144

# For development workloads
vm.zone_reclaim_mode = 0
vm.vfs_cache_pressure = 50

# I/O scheduler optimizations
kernel.io_delay_type = 1
vm.laptop_mode = 0
vm.block_dump = 0

# Container memory settings
vm.oom_kill_allocating_task = 1
vm.panic_on_oom = 0
kernel.panic_on_oops = 0
kernel.panic = 10